# 概述
- 文档数据库，或者说对象数据库，设计结构上不符合三范式

# 数据库
在mongo中数据库名就是存储的文件名

- admin 类似mysql中的root，记录用户信息
- local 会记录所有本地集合，类似binlog信息
- config 存储分片信息

# 表
- 默认相同表下可以插入不同结构的数值
- 可以添加表约束

# view
从 3.4 开始, MongoDB 添加了基于已存在的集合或者 View (视图) 创建只读的 View 支持.

# 索引
和mysql类似的底层索引结构

## objectID
如果插入数据没有 _id ，每条记录都会自动生成 objectId 通常是在客户端driver生成24个16进制组成的12字节字符串，生成规则如下

- 时间戳 4b，索引是b+树，而时间戳在前，保证了每秒内有序插入，同时能从时间戳中解析出文案创建时间
- 主机标示，3b，主机名的hash
- pid 2b
- 计数器 3b 1s内最多创建1.6千万

时间戳和计数器保证节点内生成唯一id，主机标示和pid尽可能保证多个不同节点也生成不同id，尽量让集群内不同节点hostname不同

# sql
CRUD、聚合、事务 都支持

## explain
在所有操作后加explain可以分析操作具体执行的性能

# 写确认
分为两个方面

1. 是否写操作已经写入磁盘日志，默认在内存中，节点挂了可能会丢失
2. 备份到多少副本节点后ack，默认异步备份

